<!doctype html>
<html lang="en">
	<head>
		<!-- Google tag (gtag.js) -->
		<script async src="https://www.googletagmanager.com/gtag/js?id=G-7Z9FV4098Q"></script>
		<script>
		window.dataLayer = window.dataLayer || [];
		function gtag(){dataLayer.push(arguments);}
		gtag('js', new Date());

		gtag('config', 'G-7Z9FV4098Q');
		</script>

		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1" />
		
		<link href="../_app/immutable/assets/0.CkCJ_Iij.css" rel="stylesheet">
		<link href="../_app/immutable/assets/5.BGKaKUs6.css" rel="stylesheet">
		<link rel="modulepreload" href="../_app/immutable/entry/start.DhW7nl4J.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/CzoHhTzk.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/ItlUb4HE.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/BmeHx-Ma.js">
		<link rel="modulepreload" href="../_app/immutable/entry/app.D6M5_GHs.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/BO4WaQy6.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/D8SAhovk.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/Lfl0KMkj.js">
		<link rel="modulepreload" href="../_app/immutable/nodes/0.Benv2eTu.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/a46zp2d9.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/CqVW6OwZ.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/haIkayOh.js">
		<link rel="modulepreload" href="../_app/immutable/nodes/5.BsZsBx08.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/CzUNRz-P.js"><!--[--><!--]--><title>UTCTF 2025 - DCΔ</title>
	</head>
	
	<body data-sveltekit-preload-data="hover" style="background-color:  #E9E9DF;">
		<div style="display: contents"><!--[--><!--[--><!----><div class="site-header svelte-1pnrz5s"><h1 id="site-title" class="svelte-1pnrz5s"> Anoth3r Site</h1> <h1 class="blink svelte-1pnrz5s">_</h1></div> <hr class="hr-top svelte-1pnrz5s"> <div class="svelte-1pnrz5s"><ul class="nav-bar svelte-1pnrz5s"><li class="svelte-1pnrz5s"><a href="/" class="svelte-1pnrz5s">Home</a></li> <li class="svelte-1pnrz5s"><a href="/about" class="svelte-1pnrz5s">About</a></li> <li class="svelte-1pnrz5s"><a href="https://github.com/fl1gg" class="svelte-1pnrz5s">Github</a></li> <li class="svelte-1pnrz5s"><a href="/contact" class="svelte-1pnrz5s">Contact</a></li></ul></div> <br class="svelte-1pnrz5s"><!----> <!----><div class="articles svelte-1qj7sin"><div class="header svelte-1qj7sin"><h1 class="title svelte-1qj7sin">UTCTF 2025 - DCΔ</h1> <p class="subtitle svelte-1qj7sin">Description of the solution to the DCΔ Crypto challenge.</p></div> <div class="tags svelte-1qj7sin"><!--[--><span class="tag svelte-1qj7sin">#utctf</span><span class="tag svelte-1qj7sin">#utctf2025</span><span class="tag svelte-1qj7sin">#crypto</span><span class="tag svelte-1qj7sin">#rsa</span><!--]--></div> <br class="svelte-1qj7sin"> <hr class="svelte-1qj7sin"> <div id="page" class="svelte-1qj7sin"><!----><p>When we open this challenge we are given the following description:</p> <!----><pre class="shiki github-dark-default" style="background-color:#0d1117;color:#e6edf3" tabindex="0"><code><span class="line"><span>Due to a national shortage of primes, the US Department of Agriculture is rationing all citizens to a limit of one generated prime number per CTF challenge.</span></span>
<span class="line"><span></span></span>
<span class="line"><span>By Sasha (@kyrili on discord)</span></span></code></pre><!----> <p>We are also given the following data, an RSA public key and ciphertext.</p> <!----><pre class="shiki github-dark-default" style="background-color:#0d1117;color:#e6edf3" tabindex="0"><code><span class="line"><span>n = 399956368360808862373914258335185223080849636197711424060797090309268643429064461492550414549161330948819635837600839124910339139212025975705016633767495247163243281423582407941339197895052969960664399531226116807938480610953640675838340969642399505783577667601230289640157854573282615113017817753471366212008719316238931155299741896658264134636523008018510523774126757209492757800553768281613227711738371473830681563493341816035127889532515105148615575695347672918819305383651095344758737833444302556494599778991752161562622963652164008980839152347260377969421014616624263631920322958235478733540894255954351848359580013695597870908080170511403061620632540407634608773118202473287854599776791229532885611074739079107324575619148211269673210431496846247978541032947073060592123529635361112170678347924377962162254827262375685704046691718585952854410058401794022674628779309507437739620598639589987596443373586284136126401843497367142210715014480599609277532331148988390798073713743339823218981940779096432112651466716648010370850152213399051968069102663753404120592506704133217642671853086570223710424683386625314802805217882906873879240914022607713870946351691046929143491841506422542038315876506588525639983398522454145866029283449</span></span>
<span class="line"><span>e = 65537</span></span>
<span class="line"><span>c = 22644125297186385803212285721101686380290089858624593588464228942417644877688212364383835956263619653769244324906844180248816686517049952319431524113838480708352331162026595736354019259708442449783760846242702532176456117138374450898213788623580234048867117546091028843127595147910526821835855070663317466469650577618010308109119812464711010326075908158768138773973732088207030977470605554056485614676156104134673446546446752627654287202815354367643042773923258958887865030737447323798382020847653880886311162447594373201951226217556835030816588457674298560260109378271244834215832992407457137601161490484862135147963942227371690835380497920998286827898323068399708168699403459009009580152834747843780155917438758224782364193716322974594031272100820264364860227674838730962348140555980411714722361909800417953974064469599278274083750031569853934963716467881656073359393449142980936480726005445774158733389270553554093627622406166942859792490275434896108377393648278975530519769034633686070931694499857110956537102727286491854314244036392929790997824274724196292688659782806587688964714529943288954314300861531138101192901942534064757877725334672680909389193357725470116673323012331269218651347104807494994267835408427908717684178629</span></span></code></pre><!----> <p>RSA relies on the hardness of factoring the product of two primes. <a href="https://www.geeksforgeeks.org/rsa-algorithm-cryptography/" rel="nofollow">Geeks for Geeks RSA Explanation</a>. This description tells us that we may be able to break the n because they used the same prime for p and q.</p> <p>Calculating square roots is significantly easier than factoring primes. I’m lazy, so lets use sympy to solve this problem for us.</p> <!----><pre class="shiki github-dark-default" style="background-color:#0d1117;color:#e6edf3" tabindex="0"><code><span class="line"><span style="color:#FF7B72">from</span><span style="color:#E6EDF3"> sympy </span><span style="color:#FF7B72">import</span><span style="color:#E6EDF3"> root</span></span>
<span class="line"><span style="color:#FF7B72">from</span><span style="color:#E6EDF3"> sympy.crypto.crypto </span><span style="color:#FF7B72">import</span><span style="color:#E6EDF3"> decipher_rsa, rsa_private_key</span></span>
<span class="line"><span style="color:#FF7B72">from</span><span style="color:#E6EDF3"> Crypto.Util.number </span><span style="color:#FF7B72">import</span><span style="color:#E6EDF3"> long_to_bytes</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E6EDF3">n </span><span style="color:#FF7B72">=</span><span style="color:#79C0FF"> 399956368360808862373914258335185223080849636197711424060797090309268643429064461492550414549161330948819635837600839124910339139212025975705016633767495247163243281423582407941339197895052969960664399531226116807938480610953640675838340969642399505783577667601230289640157854573282615113017817753471366212008719316238931155299741896658264134636523008018510523774126757209492757800553768281613227711738371473830681563493341816035127889532515105148615575695347672918819305383651095344758737833444302556494599778991752161562622963652164008980839152347260377969421014616624263631920322958235478733540894255954351848359580013695597870908080170511403061620632540407634608773118202473287854599776791229532885611074739079107324575619148211269673210431496846247978541032947073060592123529635361112170678347924377962162254827262375685704046691718585952854410058401794022674628779309507437739620598639589987596443373586284136126401843497367142210715014480599609277532331148988390798073713743339823218981940779096432112651466716648010370850152213399051968069102663753404120592506704133217642671853086570223710424683386625314802805217882906873879240914022607713870946351691046929143491841506422542038315876506588525639983398522454145866029283449</span></span>
<span class="line"><span style="color:#E6EDF3">e </span><span style="color:#FF7B72">=</span><span style="color:#79C0FF"> 65537</span></span>
<span class="line"><span style="color:#E6EDF3">c </span><span style="color:#FF7B72">=</span><span style="color:#79C0FF"> 22644125297186385803212285721101686380290089858624593588464228942417644877688212364383835956263619653769244324906844180248816686517049952319431524113838480708352331162026595736354019259708442449783760846242702532176456117138374450898213788623580234048867117546091028843127595147910526821835855070663317466469650577618010308109119812464711010326075908158768138773973732088207030977470605554056485614676156104134673446546446752627654287202815354367643042773923258958887865030737447323798382020847653880886311162447594373201951226217556835030816588457674298560260109378271244834215832992407457137601161490484862135147963942227371690835380497920998286827898323068399708168699403459009009580152834747843780155917438758224782364193716322974594031272100820264364860227674838730962348140555980411714722361909800417953974064469599278274083750031569853934963716467881656073359393449142980936480726005445774158733389270553554093627622406166942859792490275434896108377393648278975530519769034633686070931694499857110956537102727286491854314244036392929790997824274724196292688659782806587688964714529943288954314300861531138101192901942534064757877725334672680909389193357725470116673323012331269218651347104807494994267835408427908717684178629</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#E6EDF3">q </span><span style="color:#FF7B72">=</span><span style="color:#E6EDF3"> root(n, </span><span style="color:#79C0FF">2</span><span style="color:#E6EDF3">) </span><span style="color:#8B949E"># calculate the square root</span></span>
<span class="line"><span style="color:#E6EDF3">q </span><span style="color:#FF7B72">=</span><span style="color:#79C0FF"> int</span><span style="color:#E6EDF3">(q) </span></span>
<span class="line"></span>
<span class="line"><span style="color:#E6EDF3">p </span><span style="color:#FF7B72">=</span><span style="color:#E6EDF3"> q</span></span>
<span class="line"><span style="color:#FF7B72">assert</span><span style="color:#E6EDF3">(q</span><span style="color:#FF7B72">*</span><span style="color:#E6EDF3">p </span><span style="color:#FF7B72">==</span><span style="color:#E6EDF3"> n) </span><span style="color:#8B949E"># make sure we actually factored n</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E6EDF3">priv </span><span style="color:#FF7B72">=</span><span style="color:#E6EDF3"> rsa_private_key(p,q,e) </span><span style="color:#8B949E"># create a private key and let sympy do the work for us</span></span>
<span class="line"><span style="color:#E6EDF3">msg </span><span style="color:#FF7B72">=</span><span style="color:#E6EDF3"> decipher_rsa(c, priv) </span><span style="color:#8B949E"># decrypt</span></span>
<span class="line"></span>
<span class="line"><span style="color:#79C0FF">print</span><span style="color:#E6EDF3">(long_to_bytes(msg)) </span><span style="color:#8B949E"># print the flag</span></span></code></pre><!----> <p>And thankfully we are able to produce the flag this way.</p> <!----><pre class="shiki github-dark-default" style="background-color:#0d1117;color:#e6edf3" tabindex="0"><code><span class="line"><span>utflag&#123;th3_t0t13nt_funct10n_uns1mpl1f13d&#125;</span></span></code></pre><!----><!----></div></div><!----><!----> <br> <div><hr></div><!----><!----><!--]--> <!--[!--><!--]--><!--]-->
			
			<script>
				{
					__sveltekit_1awhzjz = {
						base: new URL("..", location).pathname.slice(0, -1)
					};

					const element = document.currentScript.parentElement;

					Promise.all([
						import("../_app/immutable/entry/start.DhW7nl4J.js"),
						import("../_app/immutable/entry/app.D6M5_GHs.js")
					]).then(([kit, app]) => {
						kit.start(app, element, {
							node_ids: [0, 5],
							data: [null,null],
							form: null,
							error: null
						});
					});
				}
			</script>
		</div>
	</body>
	
</html>
